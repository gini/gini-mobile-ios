<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Integration  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="Integration  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
        <img class="logo-icon" src="img/logo.png"/>
    
        </a>
        
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/gini/gini-mobile-ios.git">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">GiniHealthSDK Reference</a>
      <img class="carat" src="img/carat.png" />
      Integration  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Documentation.html">Documentation</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="installation.html">Installation</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="integration.html">Integration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="customization-guide.html">Customization guide</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="migration-guide.html">Migration guide</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="event-tracking-guide.html">Event tracking guide</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="testing.html">Testing</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="license.html">License</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Classes.html">Other Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Classes.html#/c:@M@GiniHealthSDK@objc(cs)BankProviderViewModel">BankProviderViewModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniColor.html">GiniColor</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniFont.html">GiniFont</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniHealth.html">GiniHealth</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniHealthConfiguration.html">GiniHealthConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PaymentReviewModel.html">PaymentReviewModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PaymentReviewViewController.html">PaymentReviewViewController</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ZoomedImageView.html">ZoomedImageView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ZoomedImageView/ScaleMode.html">– ScaleMode</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ZoomedImageView/Offset.html">– Offset</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Global Variables.html">Other Global Variables</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Global%20Variables.html#/s:13GiniHealthSDK0aB10SDKVersionSSvp">GiniHealthSDKVersion</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Enumerations.html">Other Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/GiniHealthError.html">GiniHealthError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PaymentReviewScreenEventType.html">PaymentReviewScreenEventType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Extensions.html">Other Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/String.html">String</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/UIColor.html">UIColor</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/UITextField.html">UITextField</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/UIView.html">UIView</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Functions.html">Other Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Functions.html#/s:13GiniHealthSDK04giniB6BundleSo8NSBundleCyF">giniHealthBundle()</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Protocols.html">Other Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/GiniHealthDelegate.html">GiniHealthDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Protocols.html#/s:13GiniHealthSDK0aB16TrackingDelegateP">GiniHealthTrackingDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ImageScrollViewDelegate.html">ImageScrollViewDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PaymentReviewScreenTrackingDelegate.html">PaymentReviewScreenTrackingDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Structures.html">Other Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DataForReview.html">DataForReview</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Structs.html#/s:13GiniHealthSDK27PageCollectionCellViewModelV">PageCollectionCellViewModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PaymentInfo.html">PaymentInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/TrackingEvent.html">TrackingEvent</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <h1 id='integration' class='heading'>Integration</h1>

<p>The Gini Health SDK for iOS provides all the UI and functionality needed to use the Gini Health API in your app to extract payment and health information from invoices. The payment information can be reviewed and then the invoice can be paid using any available payment provider app (e.g., banking app).</p>

<p>The Gini Health API provides an information extraction service for analyzing health invoices. Specifically, it extracts information such as the document sender or the payment relevant information (amount to pay, IBAN, etc.). In addition it also provides a secure channel for sharing payment related information between clients. </p>

<p><strong>Note</strong> For supporting each payment provider you need to specify <code>LSApplicationQueriesSchemes</code> in your <code>Info.plist</code> file. App schemes for specification will be provided by Gini.</p>
<h2 id='upload-the-document' class='heading'>Upload the document</h2>

<p>Document upload can be done in two ways:</p>

<p>using <code>GiniHealthAPILibrary</code>
using <code>GiniCapture</code></p>
<h2 id='ginihealthapi-initialization' class='heading'>GiniHealthAPI initialization</h2>

<p>You should have received Gini Health API client credentials from us. Please get in touch with us in case you don&rsquo;t have them.</p>

<p>If you want to use a transparent proxy with your own authentication you can specify your own domain and add <code>AlternativeTokenSource</code> protocol implementation:</p>
<pre class="highlight swift"><code> <span class="k">let</span> <span class="nv">apiLib</span> <span class="o">=</span>  <span class="kt">GiniHealthAPI</span><span class="o">.</span><span class="kt">Builder</span><span class="p">(</span><span class="nv">customApiDomain</span><span class="p">:</span> <span class="s">"api.custom.net"</span><span class="p">,</span>
                                 <span class="nv">alternativeTokenSource</span><span class="p">:</span> <span class="kt">MyAlternativeTokenSource</span><span class="p">)</span>
                                 <span class="o">.</span><span class="nf">build</span><span class="p">()</span>
</code></pre>

<p>The token your provide will be added as a bearer token to all api.custom.net requests.</p>
<h2 id='certificate-pinning' class='heading'>Certificate pinning</h2>

<p>If you want to use <em>Certificate pinning</em>, provide metadata for the upload process, you can pass both your public key pinning configuration (see <a href="https://github.com/datatheorem/TrustKit">TrustKit repo</a> for more information)</p>
<pre class="highlight swift"><code>    <span class="k">let</span> <span class="nv">giniApiLib</span> <span class="o">=</span> <span class="kt">GiniHealthAPI</span>
        <span class="o">.</span><span class="kt">Builder</span><span class="p">(</span><span class="nv">client</span><span class="p">:</span> <span class="kt">Client</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"your-id"</span><span class="p">,</span>
                                <span class="nv">secret</span><span class="p">:</span> <span class="s">"your-secret"</span><span class="p">,</span>
                                <span class="nv">domain</span><span class="p">:</span> <span class="s">"your-domain"</span><span class="p">),</span>
                 <span class="nv">api</span><span class="p">:</span> <span class="o">.</span><span class="k">default</span><span class="p">,</span>
                 <span class="nv">pinningConfig</span><span class="p">:</span> <span class="n">yourPublicPinningConfig</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">build</span><span class="p">()</span>
</code></pre>

<blockquote>
<p>⚠️  <strong>Important</strong></p>

<ul>
<li>The document metadata for the upload process is intended to be used for reporting.</li>
</ul>
</blockquote>
<h2 id='ginihealth-initialization' class='heading'>GiniHealth initialization</h2>

<p>Now that the <code>GiniHealthAPI</code> has been initialized, you can initialize <code><a href="Classes/GiniHealth.html">GiniHealth</a></code></p>
<pre class="highlight swift"><code> <span class="k">let</span> <span class="nv">healthSDK</span> <span class="o">=</span> <span class="kt">GiniHealth</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">giniApiLib</span><span class="p">)</span>
</code></pre>

<p>and upload your document if you plan to do it with <code><a href="Classes/GiniHealth.html">GiniHealth</a></code>. First you need get document service and create partial document.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">documentService</span><span class="p">:</span> <span class="kt">DefaultDocumentService</span> <span class="o">=</span> <span class="n">healthSDK</span><span class="o">.</span><span class="nf">documentService</span><span class="p">()</span>
<span class="n">documentService</span><span class="o">.</span><span class="nf">createDocument</span><span class="p">(</span><span class="nv">fileName</span><span class="p">:</span><span class="s">"ginipay-partial"</span><span class="p">,</span>
                               <span class="nv">docType</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span>
                               <span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="nf">partial</span><span class="p">(</span><span class="n">documentData</span><span class="p">),</span>
                               <span class="nv">metadata</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>

<p>The method above returns the completion block with partial <code>Document</code> in success case.</p>

<p>After receiving the partial document in completion you can get actual composite document:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">partialDocs</span> <span class="o">=</span> <span class="p">[</span><span class="kt">PartialDocumentInfo</span><span class="p">(</span><span class="nv">document</span><span class="p">:</span> <span class="n">createdDocument</span><span class="o">.</span><span class="n">links</span><span class="o">.</span><span class="n">document</span><span class="p">)]</span>
 <span class="k">self</span><span class="o">.</span><span class="n">healthSDK</span><span class="o">.</span><span class="n">documentService</span>
            <span class="o">.</span><span class="nf">createDocument</span><span class="p">(</span><span class="nv">fileName</span><span class="p">:</span> <span class="s">"ginipay-composite"</span><span class="p">,</span>
                            <span class="nv">docType</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span>
                            <span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="nf">composite</span><span class="p">(</span><span class="kt">CompositeDocumentInfo</span><span class="p">(</span><span class="nv">partialDocuments</span><span class="p">:</span> <span class="n">partialDocs</span><span class="p">)),</span>
                            <span class="nv">metadata</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>

</code></pre>
<h2 id='check-preconditions' class='heading'>Check preconditions</h2>

<p>There are three methods in GiniHealth:</p>

<ul>
<li><code>healthSDK.isAnyBankingAppInstalled(appSchemes: [String])</code> without a networking call, returns true when at least the one of the listed among <code>LSApplicationQueriesSchemes</code> in your <code>Info.plist</code> is installed on the device and can support Gini Pay functionality,</li>
<li><code>healthSDK.checkIfAnyPaymentProviderAvailable()</code> with a networking call, returns a list of availible payment provider or informs that there are no supported banking apps installed,</li>
<li><code>healthSDK.checkIfDocumentIsPayable(docId: String)</code> returns true if Iban was extracted.</li>
</ul>
<h2 id='fetching-data-for-payment-review-screen' class='heading'>Fetching data for payment review screen</h2>

<p>If the preconditions checks are succeeded you can fetch the document and extractions for Payment Review screen:</p>
<pre class="highlight swift"><code><span class="n">healthSDK</span><span class="o">.</span><span class="nf">fetchDataForReview</span><span class="p">(</span><span class="nv">documentId</span><span class="p">:</span> <span class="n">documentId</span><span class="p">,</span>
                              <span class="nv">completion</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">DataForReview</span><span class="p">,</span> <span class="kt">GiniHealthError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span>
</code></pre>

<p>The method above returns the completion block with the struct <code><a href="Structs/DataForReview.html">DataForReview</a></code>, which includes document and extractions.</p>
<h2 id='payment-review-screen-initialization' class='heading'>Payment review screen initialization</h2>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">vc</span> <span class="o">=</span> <span class="kt">PaymentReviewViewController</span><span class="o">.</span><span class="nf">instantiate</span><span class="p">(</span><span class="n">with</span> <span class="nv">giniHealth</span><span class="p">:</span> <span class="n">healthSDK</span><span class="p">,</span>
                                                 <span class="nv">data</span><span class="p">:</span> <span class="n">dataForReview</span><span class="p">)</span>
</code></pre>

<p>The screen can be presented modally, used in a container view or pushed to a navigation view controller. Make sure to add your own navigational elements around the provided views.</p>

<p>To also use the <code><a href="Classes/GiniHealthConfiguration.html">GiniHealthConfiguration</a></code>:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">giniConfiguration</span> <span class="o">=</span> <span class="kt">GiniHealthConfiguration</span><span class="p">()</span>
<span class="n">config</span><span class="o">.</span><span class="n">loadingIndicatorColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">black</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="n">healthSDK</span><span class="o">.</span><span class="nf">setConfiguration</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</code></pre>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2022 <a class="link" href="https://gini.net" target="_blank" rel="external noopener">Gini GmbH</a>. All rights reserved. (Last updated: 2022-02-28)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.14.1</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
