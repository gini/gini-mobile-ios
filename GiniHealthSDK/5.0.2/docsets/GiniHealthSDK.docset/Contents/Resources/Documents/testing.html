<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Testing  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="Testing  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
        <img class="logo-icon" src="img/logo.png"/>
    
        </a>
        
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/gini/gini-mobile-ios.git">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">GiniHealthSDK Reference</a>
      <img class="carat" src="img/carat.png" />
      Testing  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Documentation.html">Documentation</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="installation.html">Installation</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="integration.html">Integration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="customization-guide.html">Customization guide</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="event-tracking-guide.html">Event tracking guide</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="testing.html">Testing</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="license.html">License</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Classes.html">Other Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CancellationToken.html">CancellationToken</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DefaultDocumentService.html">DefaultDocumentService</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Extraction.html">Extraction</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Extraction/Box.html">– Box</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Extraction/Candidate.html">– Candidate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ExtractionResult.html">ExtractionResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniHealth.html">GiniHealth</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniHealth/Constants.html">– Constants</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniHealthConfiguration.html">GiniHealthConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PaymentComponentsController.html">PaymentComponentsController</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Global Variables.html">Other Global Variables</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Global%20Variables.html#/s:13GiniHealthSDK0aB10SDKVersionSSvp">GiniHealthSDKVersion</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Enumerations.html">Other Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ExtractionType.html">ExtractionType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/GiniError.html">GiniError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/GiniHealthError.html">GiniHealthError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/GiniHealthImage.html">GiniHealthImage</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/LogLevel.html">LogLevel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PaymentReviewScreenEventType.html">PaymentReviewScreenEventType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PaymentState.html">PaymentState</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PlatformSupported.html">PlatformSupported</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Extensions.html">Other Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Extensions.html#/AppKit">AppKit</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Functions.html">Other Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Functions.html#/s:13GiniHealthSDK04giniB6BundleSo8NSBundleCyF">giniHealthBundle()</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Protocols.html">Other Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/GiniErrorProtocol.html">GiniErrorProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/GiniHealthDelegate.html">GiniHealthDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Protocols.html#/s:13GiniHealthSDK0aB16TrackingDelegateP">GiniHealthTrackingDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PaymentComponentsConfigurationProvider.html">PaymentComponentsConfigurationProvider</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PaymentComponentsControllerProtocol.html">PaymentComponentsControllerProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PaymentComponentsStringsProvider.html">PaymentComponentsStringsProvider</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PaymentReviewScreenTrackingDelegate.html">PaymentReviewScreenTrackingDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Structures.html">Other Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CompositeDocument.html">CompositeDocument</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CompositeDocumentInfo.html">CompositeDocumentInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DataForReview.html">DataForReview</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document.html">Document</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/Layout.html">– Layout</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/Progress.html">– Progress</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/Origin.html">– Origin</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/SourceClassification.html">– SourceClassification</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/Page.html">– Page</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/Links.html">– Links</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/DocType.html">– DocType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/TypeV2.html">– TypeV2</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/Metadata.html">– Metadata</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ExtractionsContainer.html">ExtractionsContainer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MinAppVersions.html">MinAppVersions</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PartialDocumentInfo.html">PartialDocumentInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PaymentInfo.html">PaymentInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PaymentProvider.html">PaymentProvider</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ProviderColors.html">ProviderColors</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/TrackingEvent.html">TrackingEvent</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Type Aliases.html">Other Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Typealiases.html#/s:13GiniHealthSDK16CompletionResulta">CompletionResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Typealiases.html#/s:13GiniHealthSDK16PaymentProvidersa">PaymentProviders</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <h1 id='testing' class='heading'>Testing</h1>
<h2 id='gini-pay-deep-link-for-your-app' class='heading'>Gini Pay Deep Link For Your App</h2>

<p>In order for banking apps to be able to return the user to your app after the payment has been resolved you need register a scheme for your app to respond to a deep link scheme known by the Gini Bank API.</p>

<blockquote>
<p><strong>Info:</strong>
You should already have a scheme and host from us. Please contact us in case you don&rsquo;t have them.</p>
</blockquote>

<p>The following is an example for the deep link <code>gini-pay://payment-requester</code>:</p>

<p><br></p>

<center><img src="img/Integration guide/SchemeExample.png" width="600"/></center>

<p></br></p>
<h2 id='testing' class='heading'>Testing</h2>

<p>An example banking app is available in the <a href="https://github.com/gini/gini-mobile-ios/blob/main/BankSDK/GiniBankSDKExample/GiniBankSDKExampleBank">Gini Mobile Monorepo iOS</a> repository.</p>

<p>In order to test using our example banking app you need to use development client credentials. This will make sure
the Gini Health SDK uses a test payment provider which will open our example banking app. To inject your API credentials into the Bank example app you need to fill in your credentials in <a href="https://github.com/gini/gini-mobile-ios/blob/main/BankSDK/GiniBankSDKExample/GiniBankSDKExampleBank/Credentials.plist">Credentials.plist</a>.</p>
<h3 id='end-to-end-testing' class='heading'>End to end testing</h3>

<p>The app scheme in our banking example app: <code>ginipay-bank://</code>. Please, specify this scheme <code>LSApplicationQueriesSchemes</code> in your app in <code>Info.plist</code> file.</p>

<p>After you&rsquo;ve set the client credentials in the example banking app and installed it on your device you can run your app.</p>
<h4 id='payment-component' class='heading'>Payment component</h4>

<p>After following the integration steps above you&rsquo;ll arrive at the <code>Payment Invoice list screen</code>, which already has integrated the <code>Payment Component</code>.
The following screenshot shows a sample list of invoices. Tapping on a CTA button will show the <code>Payment Component</code> in a bottom sheet if a payment provider isn&rsquo;t selected already.</p>

<p><br></p>

<center><img src="img/Integration guide/InvoiceListWithPaymentComponent.png" height="500"/></center>

<p></br></p>
<h4 id='bank-selection-bottom-sheet' class='heading'>Bank Selection Bottom sheet</h4>

<p>By clicking the picker you should see the <code>BankSelectionBottomSheet</code> with the list of available banking apps (including <code>Gini-Test-Payment-Provider</code> and other testing and production apps).</p>

<p><br></p>

<center><img src="img/Integration guide/BankSelectionBottomSheet.png" height="500"/></center>

<p></br></p>
<h4 id='more-information-and-faq' class='heading'>More information and FAQ</h4>

<p>By clicking the more information in the bottom <code>Payment Component</code> view you should see the <code>Payment feature Info screen</code> with information about the payment feature and an FAQ section.</p>

<p><br></p>

<center><img src="img/Integration guide/PaymentFeatureInformationScreen.png" height="500"/></center>

<p></br></p>
<h4 id='payment-review' class='heading'>Payment Review</h4>

<p>By clicking the <code>Continue to overview</code> button on a bottom <code>Payment Component</code> view you should see the <code>Payment Review screen</code>, which shows the invoice&rsquo;s pages and the payment information. It also allows editing the payment information. The <code>To the banking app</code> button should have the colors of the banking app, which was selected in the payment component view. There should also be a bank picker with selected payment provider in the left down part of the view. You can tap on it and change the payment provider.</p>

<p>Check that the extractions and the document preview are shown and then press the <code>To the banking app</code> button:</p>

<p><br></p>

<center><img src="img/Integration guide/PaymentReviewScreen.png" height="500"/></center>

<p></br></p>
<h4 id='execute-payment' class='heading'>Execute payment</h4>

<p>When clicking the <code>To the banking app</code> button on the payment review you should be redirected to the example banking app where the payment information will be fetched from Gini (including any changes you made on the payment review). Press the &ldquo;Pay&rdquo; button to execute a test payment which will mark the payment as paid in the <a href="https://health-api.gini.net/documentation/#gini-health-api-documentation">Gini Health API</a>.
You should be redirected to the example banking app where the final extractions are shown:</p>

<p><br></p>

<center><img src="img/Integration guide/ReviewScreenBeforeResolvingPayment.PNG" height="500"/></center>

<p></br></p>

<p>After you press the <code>Pay</code> button the Gini Bank SDK resolves the payment and allows you to return to your app:</p>

<p><br></p>

<center><img src="img/Integration guide/ReviewScreenAfterResolvingPayment.PNG" height="500"/></center>

<p></br></p>
<h4 id='return-to-your-app' class='heading'>Return to your app</h4>

<p>After the test payment has been executed, the example banking app should show a &ldquo;Return to Health app&rdquo; button which should take you back to your app.</p>

<p>For handling incoming url in your app after redirecting back from the banking app you need to implement to handle the incoming url:
The following is an example for the url <code>gini-pay://payment-requester</code>:</p>
<pre class="highlight swift"><code>    <span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">app</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span>
                     <span class="kd">open</span> <span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span><span class="p">,</span>
                     <span class="nv">options</span><span class="p">:</span> <span class="p">[</span><span class="kt">UIApplication</span><span class="o">.</span><span class="kt">OpenURLOptionsKey</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[:])</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">url</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s">"payment-requester"</span> <span class="p">{</span>
            <span class="nf">processBankUrl</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span>
            <span class="c1">// hadle incoming url from the banking app</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">true</span>
    <span class="p">}</span>
</code></pre>

<p>Here you can obtain the <code>paymentRequestId</code> and check the payment status:</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">processBankUrl</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">components</span> <span class="o">=</span> <span class="kt">URLComponents</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span> <span class="nv">resolvingAgainstBaseURL</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">queryItems</span> <span class="o">=</span> <span class="n">components</span><span class="o">.</span><span class="n">queryItems</span> <span class="p">{</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">paymentRequestId</span> <span class="o">=</span> <span class="n">queryItems</span><span class="o">.</span><span class="nf">first</span><span class="p">(</span><span class="nv">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">"paymentRequestId"</span> <span class="p">})?</span><span class="o">.</span><span class="n">value</span> <span class="p">{</span>
            <span class="n">health</span><span class="o">.</span><span class="nf">getPaymentRequest</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">paymentRequestId</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">result</span> <span class="k">in</span>
                <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
                <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">paymentRequest</span><span class="p">):</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"paymentStatus: </span><span class="se">\(</span><span class="kt">PaymentStatus</span><span class="p">(</span><span class="nv">rawValue</span><span class="p">:</span> <span class="n">paymentRequest</span><span class="o">.</span><span class="n">status</span><span class="p">)</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"Failed to retrieve payment request: </span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>With these steps completed you have verified that your app, the Gini Health API, the Gini Health SDK and the Gini
Bank SDK work together correctly.</p>
<h3 id='testing-in-production' class='heading'>Testing in production</h3>

<p>The steps are the same but instead of the development client credentials you will need to use production client
credentials. This will make sure the Gini Health SDK receives real payment providers which open real banking apps.</p>

<p>You will also need to install a banking app which uses the Gini Bank SDK. Please contact us in case you don&rsquo;t know
which banking app(s) to install.</p>

<p>Lastly make sure that for production you register the scheme we provided you for deep linking and you are not using 
<code>gini-pay://payment-requester</code>.</p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2025 <a class="link" href="https://gini.net" target="_blank" rel="external noopener">Gini GmbH</a>. All rights reserved. (Last updated: 2025-01-14)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.14.3</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
