<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Getting started  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="Getting started  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
        <img class="logo-icon" src="img/logo.png"/>
    
        </a>
        
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/gini/gini-mobile-ios.git">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">GiniHealthAPILibrary Reference</a>
      <img class="carat" src="img/carat.png" />
      Getting started  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Documentation.html">Documentation</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="installation.html">Installation</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="getting-started.html">Getting started</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="migration-guide.html">Migration guide</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="license.html">License</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Classes.html">Other Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CancellationToken.html">CancellationToken</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DefaultDocumentService.html">DefaultDocumentService</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Extraction.html">Extraction</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Extraction/Box.html">– Box</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Extraction/Candidate.html">– Candidate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ExtractionResult.html">ExtractionResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniHealthAPI.html">GiniHealthAPI</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniHealthAPI/Builder.html">– Builder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/GiniHealthAPI/Constants.html">– Constants</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PaymentService.html">PaymentService</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Token.html">Token</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Global Variables.html">Other Global Variables</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Global%20Variables.html#/s:20GiniHealthAPILibrary0abC7VersionSSvp">GiniHealthAPILibraryVersion</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Enumerations.html">Other Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/APIDomain.html">APIDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ExtractionType.html">ExtractionType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/GiniError.html">GiniError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/LogEvent.html">LogEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/LogLevel.html">LogLevel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PaymentState.html">PaymentState</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PlatformSupported.html">PlatformSupported</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/UserDomain.html">UserDomain</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Functions.html">Other Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Functions.html#/s:20GiniHealthAPILibrary3Log_5eventySS_AA0D5EventOtF">Log(_:event:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Protocols.html">Other Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/AlternativeTokenSource.html">AlternativeTokenSource</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/DocumentService.html">DocumentService</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/GiniErrorProtocol.html">GiniErrorProtocol</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Structures.html">Other Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Client.html">Client</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CompositeDocument.html">CompositeDocument</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CompositeDocumentInfo.html">CompositeDocumentInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document.html">Document</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/Layout.html">– Layout</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/Page.html">– Page</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/Progress.html">– Progress</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/Origin.html">– Origin</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/SourceClassification.html">– SourceClassification</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/DocType.html">– DocType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/Links.html">– Links</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/TypeV2.html">– TypeV2</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Document/Metadata.html">– Metadata</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ExtractionsContainer.html">ExtractionsContainer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Structs.html#/s:20GiniHealthAPILibrary5LinksV">Links</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MinAppVersions.html">MinAppVersions</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PartialDocumentInfo.html">PartialDocumentInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Payment.html">Payment</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Structs.html#/s:20GiniHealthAPILibrary12PaymentLinksV">PaymentLinks</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PaymentProvider.html">PaymentProvider</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PaymentProviderResponse.html">PaymentProviderResponse</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PaymentRequest.html">PaymentRequest</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ProviderColors.html">ProviderColors</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Type Aliases.html">Other Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Typealiases.html#/s:20GiniHealthAPILibrary16CompletionResulta">CompletionResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Typealiases.html#/s:20GiniHealthAPILibrary16PaymentProvidersa">PaymentProviders</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Typealiases.html#/s:20GiniHealthAPILibrary15PaymentRequestsa">PaymentRequests</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <h1 id='getting-started' class='heading'>Getting started</h1>

<p>The Gini Health API Library provides ways to interact with the Gini Health API and therefore, adds the possiblity to scan documents and retrieve the extractions from them.</p>

<p>In order to create an instance of the <code><a href="Classes/GiniHealthAPI.html">GiniHealthAPI</a></code> class, you need both your client id and your client secret. If you don’t have a client id and client secret yet, you need to contact us and we’ll provide you with credential.</p>

<p>All requests to the Gini Health API are made on behalf of a user. This means particularly that all created documents are bound to a specific user account. But since you are most likely only interested in the results of the semantic document analysis and not in a cloud document storage system, the Gini Health API has the feature of anonymous users. This means that user accounts are created on the fly and the user account is unknown to your application’s user.</p>
<h2 id='initializing-the-library' class='heading'>Initializing the library</h2>

<p>To initialize the library, you just need to provide the API credentials:</p>
<pre class="highlight swift"><code>    <span class="k">let</span> <span class="nv">giniHealthAPI</span> <span class="o">=</span> <span class="kt">GiniHealthAPI</span>
        <span class="o">.</span><span class="kt">Builder</span><span class="p">(</span><span class="nv">client</span><span class="p">:</span> <span class="kt">Client</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"your-id"</span><span class="p">,</span>
                                <span class="nv">secret</span><span class="p">:</span> <span class="s">"your-secret"</span><span class="p">,</span>
                                <span class="nv">domain</span><span class="p">:</span> <span class="s">"your-domain"</span><span class="p">))</span>
        <span class="o">.</span><span class="nf">build</span><span class="p">()</span>
</code></pre>
<h2 id='public-key-pinning' class='heading'>Public Key Pinning</h2>

<p>If you want to use <em>Certificate pinning</em>, provide metadata for the upload process, you can pass both your public key pinning configuration, the metadata information (the <a href="https://health-api.gini.net/documentation/v3/#gini-health-api-documentation-v3-0">Gini Health API</a> is used by default) as follows:</p>
<pre class="highlight swift"><code>    <span class="k">let</span> <span class="nv">yourPublicPinningConfig</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">"health-api.gini.net"</span><span class="p">:</span> <span class="p">[</span>
            <span class="c1">// old *.gini.net public key</span>
            <span class="s">"cNzbGowA+LNeQ681yMm8ulHxXiGojHE8qAjI+M7bIxU="</span><span class="p">,</span>
            <span class="c1">// new *.gini.net public key, active from around June 2020</span>
            <span class="s">"zEVdOCzXU8euGVuMJYPr3DUU/d1CaKevtr0dW0XzZNo="</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s">"user.gini.net"</span><span class="p">:</span> <span class="p">[</span>
            <span class="c1">// old *.gini.net public key</span>
            <span class="s">"cNzbGowA+LNeQ681yMm8ulHxXiGojHE8qAjI+M7bIxU="</span><span class="p">,</span>
            <span class="c1">// new *.gini.net public key, active from around June 2020</span>
            <span class="s">"zEVdOCzXU8euGVuMJYPr3DUU/d1CaKevtr0dW0XzZNo="</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">]</span>
    <span class="k">let</span> <span class="nv">giniHealthAPI</span> <span class="o">=</span> <span class="kt">GiniHealthAPI</span>
        <span class="o">.</span><span class="kt">Builder</span><span class="p">(</span><span class="nv">client</span><span class="p">:</span> <span class="kt">Client</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"your-id"</span><span class="p">,</span>
                                <span class="nv">secret</span><span class="p">:</span> <span class="s">"your-secret"</span><span class="p">,</span>
                                <span class="nv">domain</span><span class="p">:</span> <span class="s">"your-domain"</span><span class="p">),</span>
                 <span class="nv">api</span><span class="p">:</span> <span class="o">.</span><span class="k">default</span><span class="p">,</span>
                 <span class="nv">pinningConfig</span><span class="p">:</span> <span class="n">yourPublicPinningConfig</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">build</span><span class="p">()</span>
</code></pre>

<blockquote>
<p>⚠️  <strong>Important</strong></p>

<ul>
<li>The document metadata for the upload process is intended to be used for reporting.</li>
</ul>
</blockquote>

<p>For customizing an API domain please, use the following snippet:</p>
<pre class="highlight swift"><code>    <span class="k">let</span> <span class="nv">giniHealthAPI</span> <span class="o">=</span> <span class="kt">GiniHealthAPI</span>
        <span class="o">.</span><span class="kt">Builder</span><span class="p">(</span><span class="nv">client</span><span class="p">:</span> <span class="kt">Client</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"your-id"</span><span class="p">,</span>
                                <span class="nv">secret</span><span class="p">:</span> <span class="s">"your-secret"</span><span class="p">,</span>
                                <span class="nv">domain</span><span class="p">:</span> <span class="s">"your-domain"</span><span class="p">),</span>
                 <span class="nv">api</span><span class="p">:</span> <span class="o">.</span><span class="nf">custom</span><span class="p">(</span><span class="nv">domain</span><span class="p">:</span> <span class="s">"custom-api.net"</span><span class="p">),</span>
                 <span class="nv">pinningConfig</span><span class="p">:</span> <span class="n">yourPublicPinningConfig</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">build</span><span class="p">()</span>
</code></pre>
<h2 id='extract-hash-from-gini-net' class='heading'>Extract Hash From gini.net</h2>

<p>The current Gini Health API public key SHA256 hash digest in Base64 encoding can be extracted with the following openssl commands:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>openssl s_client -servername gini.net -connect gini.net:443 | openssl x509 -pubkey -noout | openssl pkey -pubin -outform der | openssl dgst -sha256 -binary | openssl enc -base64
</code></pre>
<h2 id='extract-hash-from-public-key' class='heading'>Extract Hash From Public Key</h2>

<p>You can also extract the hash from a public key. The following example shows how to extract it from a public key named gini.pub:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>cat gini.pub | openssl pkey -pubin -outform der | openssl dgst -sha256 -binary | openssl enc -base64
</code></pre>
<h2 id='using-the-library' class='heading'>Using the library</h2>

<p>You can also extract the hash from a public key. The following example shows how to extract it from a public key named gini.pub:</p>

<p>Now that the <code><a href="Classes/GiniHealthAPI.html">GiniHealthAPI</a></code> has been initialized, you can start using it. To do so, just get the <em>Document service</em> from it. </p>

<p>On one hand, if you choose to continue with the <code>default</code> <em>Document service</em>, you should use the <code><a href="Classes/DefaultDocumentService.html">DefaultDocumentService</a></code>:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">documentService</span><span class="p">:</span> <span class="kt">DefaultDocumentService</span> <span class="o">=</span> <span class="n">giniHealthAPI</span><span class="o">.</span><span class="nf">documentService</span><span class="p">()</span>
</code></pre>

<p>You are all set 🚀! You can start using the Gini Health API through the <code>documentService</code>.</p>
<h3 id='upload-a-document' class='heading'>Upload a document</h3>

<p>As the key aspect of the Gini Health API is to provide information extraction for analyzing documents, the API is mainly built around the concept of documents. A document can be any written representation of information such as invoices, reminders, contracts and so on.</p>

<p>The Gini Health API lib supports creating documents from images, PDFs or UTF-8 encoded text. Images are usually a picture of a paper document which was taken with the device’s camera.</p>

<p>The following example shows how to create a new document from a byte array containing a JPEG image.</p>
<pre class="highlight swift"><code><span class="n">documentService</span><span class="o">.</span><span class="nf">createDocument</span><span class="p">(</span><span class="nv">fileName</span><span class="p">:</span> <span class="s">"myFirstDocument.jpg"</span><span class="p">,</span>
                            <span class="nv">docType</span><span class="p">:</span> <span class="n">docType</span><span class="p">,</span>
                            <span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="nf">partial</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                            <span class="nv">metadata</span><span class="p">:</span> <span class="n">metadata</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="k">case</span> <span class="kd">let</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">createdDocument</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"📄 Created document with id: </span><span class="se">\(</span><span class="n">createdDocument</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s"> "</span> <span class="o">+</span>
            <span class="s">"for vision document </span><span class="se">\(</span><span class="n">document</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="nf">completion</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">createdDocument</span><span class="p">))</span>
    <span class="k">case</span> <span class="kd">let</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"❌ Document creation failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="nf">completion</span><span class="p">(</span><span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Each page of a document needs to uploaded as a partial document. In addition documents consisting of one page also should be uploaded as a partial document.</p>

<blockquote>
<p>⚠️  <strong>Note</strong></p>

<ul>
<li>PDFs and UTF-8 encoded text should also be uploaded as partial documents. Even though PDFs might contain multiple pages and text is “pageless”, creating partial documents for these keeps your interaction with Gini consistent for all the supported document types.</li>
</ul>
</blockquote>

<p>Extractions are not available for partial documents. Creating a partial document is analogous to an upload. For retrieving extractions see Getting extractions section.</p>

<blockquote>
<p>⚠️  <strong>Note</strong></p>

<ul>
<li>The <code>filename</code> (myFirstDocument.jpg in the example) is not required, it could be nil, but setting a filename is a good practice for human readable document identification.</li>
</ul>
</blockquote>
<h4 id='setting-the-document-type-hint' class='heading'>Setting the document type hint</h4>

<p>To easily set the document type hint we introduced the <code>DocType</code> enum. It is safer and easier to use than a String. For more details about the document type hints see the Document Type Hints in the <a href="https://health-api.gini.net/documentation/v3/#document-types">Gini Health API documentation</a></p>
<h3 id='getting-extractions' class='heading'>Getting extractions</h3>

<p>After you have successfully created the partial documents, you most likely want to get the extractions for the document. Composite documents consist of previously created partial documents. You can consider creating partial documents analogous to uploading pages of a document and creating a composite document analogous to processing those pages as a single document.</p>

<p>Before retrieving extractions you need to create a composite document from your partial documents</p>

<p>Gini needs to process the composite document first before you can fetch the extractions. Effectively this means that you won’t get any extractions before the composite document is fully processed. The processing time may vary, usually it is in the range of a couple of seconds, but blurred or slightly rotated images are known to drasticly increase the processing time.</p>

<p>The <code><a href="Protocols/DocumentService.html">DocumentService</a></code> provides <code>extractions()</code> method which can be used to fetch the extractions after the processing of the document is completed. The following example shows how to achieve this in detail.</p>
<pre class="highlight swift"><code><span class="n">documentService</span>
    <span class="o">.</span><span class="nf">createDocument</span><span class="p">(</span><span class="nv">fileName</span><span class="p">:</span> <span class="s">"composite-myFirstDocument.jpg"</span><span class="p">,</span>
                    <span class="nv">docType</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span>
                    <span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="nf">composite</span><span class="p">(</span><span class="kt">CompositeDocumentInfo</span><span class="p">(</span><span class="nv">partialDocuments</span><span class="p">:</span> <span class="n">documents</span><span class="p">)),</span>
                    <span class="nv">metadata</span><span class="p">:</span> <span class="n">metadata</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="k">case</span> <span class="kd">let</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">createdDocument</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"🔎 Starting analysis for composite document with id </span><span class="se">\(</span><span class="n">createdDocument</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">documentService</span><span class="o">.</span><span class="nf">extractions</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="n">createdDocument</span><span class="p">,</span>
                           <span class="nv">cancellationToken</span><span class="p">:</span> <span class="kt">CancellationToken</span><span class="p">())</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">async</span> <span class="p">{</span>
                <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
                <span class="k">case</span> <span class="kd">let</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">extractionResult</span><span class="p">):</span>
                    <span class="nf">completion</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">extractionResult</span><span class="o">.</span><span class="n">extractions</span><span class="p">))</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"The specific extractions: </span><span class="se">\(</span><span class="n">extractionResult</span><span class="o">.</span><span class="n">extractions</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"The line item compound extractions : </span><span class="se">\(</span><span class="n">extractionResult</span><span class="o">.</span><span class="n">lineItems</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="k">case</span> <span class="kd">let</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
                    <span class="nf">completion</span><span class="p">(</span><span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="o">.</span><span class="nf">apiError</span><span class="p">(</span><span class="n">error</span><span class="p">)))</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="k">case</span> <span class="kd">let</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"❌ Composite document creation failed: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="nf">completion</span><span class="p">(</span><span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='sending-feedback' class='heading'>Sending feedback</h3>

<p>Depending on your use case your app probably presents the extractions to the user and gives them the opportunity to correct them. By sending us feedback for the extractions we are able to continuously improve the extraction quality.</p>

<p>Your app should send feedback only for the extractions the user has seen and accepted. Feedback should be sent for corrected extractions and for correct extractions. The code example below shows how to correct extractions and send feedback.</p>
<pre class="highlight swift"><code><span class="k">guard</span> <span class="k">let</span> <span class="nv">document</span> <span class="o">=</span> <span class="n">document</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>

<span class="c1">// specific extractions,that we've received in the section above</span>
<span class="k">var</span> <span class="nv">updatedExtractions</span><span class="p">:</span> <span class="p">[</span><span class="kt">Extraction</span><span class="p">]</span> <span class="o">=</span> <span class="n">extractionResult</span><span class="o">.</span><span class="n">extractions</span>

<span class="c1">// amountToPay was wrong, we'll correct it</span>
<span class="n">updatedExtractions</span><span class="o">.</span><span class="n">first</span> <span class="p">{</span>
    <span class="nv">$0</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">"amountToPay"</span>
<span class="p">}?</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s">"31:00:EUR"</span>

<span class="n">documentService</span><span class="o">.</span><span class="nf">submitFeedback</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="n">document</span><span class="p">,</span> <span class="nv">with</span><span class="p">:</span> <span class="n">updatedExtractions</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nv">success</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"🚀 Feedback sent with </span><span class="se">\(</span><span class="n">updatedExtractions</span><span class="o">.</span><span class="n">count</span><span class="se">)</span><span class="s"> extractions"</span><span class="p">)</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"❌ Error sending feedback for document with id: </span><span class="se">\(</span><span class="n">document</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s"> error: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id='handling-errors' class='heading'>Handling errors</h3>

<p>All errors that occur during request execution are handed over transparently. You can react on those errors in the <code>failure</code> case of the completion result. We recommend checking the network status when a request failed and retrying it.</p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2024 <a class="link" href="https://gini.net" target="_blank" rel="external noopener">Gini GmbH</a>. All rights reserved. (Last updated: 2024-08-29)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.14.3</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
